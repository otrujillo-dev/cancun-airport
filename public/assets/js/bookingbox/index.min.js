(()=>{var e;(e={input_currency:document.querySelectorAll(".xyz-toggle-currency"),input_from:document.getElementById("xyz-input-from"),input_from_items:document.getElementById("xyz-input-from-items"),input_to:document.getElementById("xyz-input-to"),input_to_items:document.getElementById("xyz-input-to-items"),btn_toggle_location:document.getElementById("xyz-btn-toggle-location"),input_from_date:document.getElementById("xyz-input-from-date"),input_from_time:document.getElementById("xyz-input-from-time"),input_passengers:document.getElementById("xyz-input-passengers"),btn_return:document.getElementById("xyz-input-return"),btn_return_child:document.getElementById("xyz-input-return-child"),input_to_date:document.getElementById("xyz-input-to-date"),input_to_time:document.getElementById("xyz-input-to-time"),errors:document.getElementById("xyz-bookingbox-errors"),btn_book:document.getElementById("xyz-btn-book"),translation:{en:{"quote.url":"/search-result","quote.from.input":"Please, enter the pickup location","quote.from.date":"Please, enter your pickup date","quote.to.input":"Please, enter the destination","quote.to.date":"Please, enter your return date","place.name":"Los Cabos International Airport (SJD)","place.lat":"23.1448084","place.lng":"-109.7186237"},es:{"quote.url":"/es/resultados-de-busqueda","quote.from.input":"Por favor, introduzca el lugar de recogida","quote.from.date":"Por favor, introduzca su fecha de recogida","quote.to.input":"Por favor, introduzca el destino","quote.to.date":"Por favor, introduzca su fecha de regreso","place.name":"Aeropuerto Internacional de Los Cabos (SJD)","place.lat":"23.1448084","place.lng":"-109.7186237"}},setup:{lang:"en",currency:"USD",serviceType:"OW",passengers:1,items:{from:{name:"",lat:"",lng:"",date:"",time:"00:00"},to:{name:"",lat:"",lng:"",date:"",time:"00:00"}},setDelay:function(e,t){var n=0;return function(){var a=this,i=arguments;clearTimeout(n),n=setTimeout((function(){e.apply(a,i)}),t||0)}},autocompleteSearch:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1?arguments[1]:void 0;if(t.length<3)return!1;fetch("/api/autocomplete",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify({keyword:t})}).then((function(e){return e.json()})).then((function(t){e.makeItems(t,n)})).catch((function(e){console.error("Error:",e)}))},makeItems:function(t,n){n.innerHTML="",t=t.items;var a=function(a){if(t.hasOwnProperty(a)){var i=document.createElement("div");i.textContent=t[a].name;var u=document.createElement("span");u.textContent=t[a].address,i.appendChild(u),i.addEventListener("click",(function(){e.setup.makeEvent(n,t[a])})),n.appendChild(i)}};for(var i in t)a(i);n.style.display="block"},makeEvent:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"xyz-input-from-items"===t.id&&(e.input_from_items.innerHTML="",e.input_from.value=n.name,e.setup.items.from.name=n.name,e.setup.items.from.lat=n.geo.lat,e.setup.items.from.lng=n.geo.lng),"xyz-input-to-items"===t.id&&(e.input_to_items.innerHTML="",e.input_to.value=n.name,e.setup.items.to.name=n.name,e.setup.items.to.lat=n.geo.lat,e.setup.items.to.lng=n.geo.lng)},setCurrency:function(e){e=e.toUpperCase(),["USD","MXN"].includes(e)&&(this.currency=e)},setDate:function(t){"xyz-input-from-date"===t.id&&(this.items.from.date=t.value,this.items.to.date=t.value,e.input_to_date.value=t.value),"xyz-input-to-date"===t.id&&(this.items.to.date=t.value,"RT"===this.serviceType&&t.value<e.input_from_date.value&&(this.items.to.date=e.input_from_date.value,e.input_to_date.value=e.input_from_date.value))},setTime:function(e){"xyz-input-from-time"===e.id&&(this.items.from.time=e.value),"xyz-input-to-time"===e.id&&(this.items.to.time=e.value)},setPassengers:function(e){this.passengers=e},setServiceType:function(t){t.checked?(this.serviceType="RT",e.btn_return_child.classList.remove("hidden")):(this.serviceType="OW",e.btn_return_child.classList.add("hidden"))},swap:function(){var t=Object.assign({},e.setup.items.from),n=Object.assign({},e.setup.items.to);e.setup.items.from.name=n.name,e.setup.items.from.lat=n.lat,e.setup.items.from.lng=n.lng,e.setup.items.to.name=t.name,e.setup.items.to.lat=t.lat,e.setup.items.to.lng=t.lng,e.input_from.value=n.name,e.input_to.value=t.name},setError:function(t){e.errors.textContent=t},getTranslate:function(t){return e.translation[e.setup.lang][t]?e.translation[e.setup.lang][t]:"Translate not found"},validate:function(){if(!e.setup.items.from.name||""===e.setup.items.from.name.trim()||!e.setup.items.from.lat||""===e.setup.items.from.lat.toString().trim()||!e.setup.items.from.lng||""===e.setup.items.from.lng.toString().trim())return this.setError(this.getTranslate("quote.from.input")),!1;if(!e.setup.items.to.name||""===e.setup.items.to.name.trim()||!e.setup.items.to.lat||""===e.setup.items.to.lat.toString().trim()||!e.setup.items.to.lng||""===e.setup.items.to.lng.toString().trim())return this.setError(this.getTranslate("quote.to.input")),!1;if(!e.setup.items.from.date||""===e.setup.items.from.date.toString().trim())return this.setError(this.getTranslate("quote.from.date")),!1;if("RT"===e.setup.serviceType&&(!e.setup.items.to.date||""===e.setup.items.to.date.toString().trim()))return this.setError(this.getTranslate("quote.to.date")),!1;var t={type:e.setup.serviceType,currency:e.setup.currency,language:e.setup.lang,passengers:e.setup.passengers,from:{name:e.setup.items.from.name,lat:e.setup.items.from.lat,lng:e.setup.items.from.lng,date:e.setup.items.from.date,time:e.setup.items.from.time},to:{name:e.setup.items.to.name,lat:e.setup.items.to.lat,lng:e.setup.items.to.lng,date:e.setup.items.to.date,time:e.setup.items.to.time}};localStorage.setItem("search",JSON.stringify(t));var n=document.createElement("form");n.method="post",n.action=e.setup.getTranslate("quote.url");var a=document.createElement("input");a.type="hidden",a.name="type",a.value=t.type,n.appendChild(a);var i=document.createElement("input");i.type="hidden",i.name="currency",i.value=t.currency,n.appendChild(i);var u=document.createElement("input");u.type="hidden",u.name="language",u.value=t.language,n.appendChild(u);var o=document.createElement("input");o.type="hidden",o.name="passengers",o.value=t.passengers,n.appendChild(o);var r=document.createElement("input");r.type="hidden",r.name="from",r.value=t.from.name,n.appendChild(r);var s=document.createElement("input");s.type="hidden",s.name="from_latitude",s.value=t.from.lat,n.appendChild(s);var m=document.createElement("input");m.type="hidden",m.name="from_longitude",m.value=t.from.lng,n.appendChild(m);var p=document.createElement("input");p.type="hidden",p.name="from_pickup_date",p.value=t.from.date+" "+t.from.time,n.appendChild(p);var l=document.createElement("input");l.type="hidden",l.name="to",l.value=t.to.name,n.appendChild(l);var d=document.createElement("input");d.type="hidden",d.name="to_latitude",d.value=t.to.lat,n.appendChild(d);var c=document.createElement("input");if(c.type="hidden",c.name="to_longitude",c.value=t.to.lng,n.appendChild(c),"RT"===this.serviceType){var f=document.createElement("input");f.type="hidden",f.name="to_pickup_date",f.value=t.to.date+" "+t.to.time,n.appendChild(f)}var g=document.createElement("input");g.type="hidden",g.name="_token",g.value=document.querySelector('meta[name="csrf-token"]').content,n.appendChild(g),document.body.appendChild(n),n.submit()},load:function(){var t=JSON.parse(localStorage.getItem("search"));if(e.setup.lang=document.documentElement.getAttribute("lang"),t){if(e.setup.setCurrency(t.currency),e.input_currency.length>0){var n=document.querySelector('button.xyz-toggle-currency[value="'.concat(t.currency,'"]'));n&&n.click()}e.btn_return.checked=!1,"RT"===t.type&&(e.btn_return.checked=!0),e.setup.setServiceType(e.btn_return),e.input_passengers.value=t.passengers,e.setup.passengers=t.passengers,e.input_from.value=t.from.name,e.input_from_date.value=t.from.date,e.input_from_time.value=t.from.time,e.setup.items.from.name=t.from.name,e.setup.items.from.lat=t.from.lat,e.setup.items.from.lng=t.from.lng,e.setup.items.from.date=t.from.date,e.setup.items.from.time=t.from.time,e.input_to.value=t.to.name,e.input_to_date.value=t.to.date,e.input_to_time.value=t.to.time,e.setup.items.to.name=t.to.name,e.setup.items.to.lat=t.to.lat,e.setup.items.to.lng=t.to.lng,e.setup.items.to.date=t.to.date,e.setup.items.to.time=t.to.time}else{e.btn_return.checked=!0,e.setup.setServiceType(e.btn_return);var a=new Date;a.setDate(a.getDate()+1),e.input_from_date.value=e.setup.dateFormat(a),e.setup.setDate(e.input_from_date),e.input_from_time.value="00:00";var i=new Date(a);i.setDate(a.getDate()+1),e.input_to_date.value=e.setup.dateFormat(i),e.setup.setDate(e.input_to_date),e.input_to_time.value="00:00",e.input_from.value=e.setup.getTranslate("place.name"),e.setup.items.from.name=e.setup.getTranslate("place.name"),e.setup.items.from.lat=e.setup.getTranslate("place.lat"),e.setup.items.from.lng=e.setup.getTranslate("place.lng")}},dateFormat:function(e){var t=e.getDate(),n=e.getMonth()+1,a=e.getFullYear();return t<10&&(t="0"+t),n<10&&(n="0"+n),"".concat(a,"-").concat(n,"-").concat(t)}}}).input_currency.length>0&&e.input_currency.forEach((function(t){t.addEventListener("click",(function(n){n.preventDefault(),e.input_currency.forEach((function(e){return e.classList.remove("active")})),t.classList.add("active"),e.setup.setCurrency(t.value)}))})),e.input_from.addEventListener("keydown",e.setup.setDelay((function(t){e.setup.autocompleteSearch(t.target.value,e.input_from_items)}),700)),e.input_from.addEventListener("focus",(function(t){e.setup.autocompleteSearch(t.target.value,e.input_from_items)})),e.input_to.addEventListener("keydown",e.setup.setDelay((function(t){e.setup.autocompleteSearch(t.target.value,e.input_to_items)}),700)),e.input_to.addEventListener("focus",(function(t){e.setup.autocompleteSearch(t.target.value,e.input_to_items)})),e.input_from_date.addEventListener("change",(function(){e.setup.setDate(this)})),e.input_from_time.addEventListener("change",(function(){e.setup.setTime(this)})),e.input_to_date.addEventListener("change",(function(){e.setup.setDate(this)})),e.input_to_time.addEventListener("change",(function(){e.setup.setTime(this)})),e.btn_return.addEventListener("change",(function(){e.setup.setServiceType(this)})),e.btn_toggle_location.addEventListener("click",(function(){e.setup.swap()})),e.input_passengers.addEventListener("change",(function(){e.setup.setPassengers(this.value)})),e.btn_book.addEventListener("click",(function(t){t.preventDefault(),e.setup.validate()})),document.addEventListener("click",(function(t){e.input_from_items.contains(t.target)||(e.input_from_items.style.display="none"),e.input_to_items.contains(t.target)||(e.input_to_items.style.display="none")})),e.setup.load()})();